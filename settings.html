<div class="titan-panel">
    <h3>ğŸ›¡ï¸ Titan Memory v2.1</h3>
    <div class="titan-desc">Rolling summarization with visual context.</div>

    <!-- Toggle & API -->
    <div class="titan-row">
        <span>Enable Extension</span>
        <input type="checkbox" id="titan-enabled" style="width: 18px; height: 18px;">
    </div>
    <div class="titan-row">
        <span>API Endpoint</span>
        <input type="text" id="titan-api" class="titan-input" placeholder="http://127.0.0.1:5000/api/v1/generate">
    </div>
     <div class="titan-row">
        <span>API Key (Optional)</span>
        <input type="password" id="titan-key" class="titan-input">
    </div>

    <!-- Thresholds -->
    <div class="titan-section-title">Triggers</div>
    <div class="titan-row">
        <span>Summarize every N messages:</span>
        <!-- Changed min to 1 to allow "Every Message" -->
        <input type="number" id="titan-threshold" class="titan-input" style="max-width: 60px;" min="1">
    </div>
    <div class="titan-desc">Set to <b>1</b> to summarize after every reply.</div>

    <div class="titan-section-title">Visuals & Context</div>
    <div class="titan-row">
        <span>Show Memory in Chat</span>
        <input type="checkbox" id="titan-show-visuals" style="width: 18px; height: 18px;">
    </div>
    <div class="titan-desc">Displays the current memory block at the bottom of the latest message.</div>

    <div class="titan-row">
        <span>Active Pruning (Reduce Tokens)</span>
        <input type="checkbox" id="titan-pruning" style="width: 18px; height: 18px;">
    </div>

    <!-- Prompt Editor -->
    <div class="titan-section-title">Summary Prompt Template</div>
    <textarea id="titan-prompt-template" class="titan-textarea"></textarea>
    <button id="titan-reset-prompt" class="titan-btn" style="margin-top:5px; width:auto; font-size:0.8em;">Reset to Default</button>

    <!-- Manual Editor -->
    <div class="titan-section-title">Current Memory State</div>
    <textarea id="titan-memory-text" class="titan-textarea" style="min-height: 150px;"></textarea>
    
    <div class="titan-row" style="margin-top: 10px;">
        <button id="titan-save" class="titan-btn">ğŸ’¾ Save Memory</button>
        <button id="titan-now" class="titan-btn">âš¡ Summarize Now</button>
        <button id="titan-wipe" class="titan-btn red">ğŸ—‘ï¸ Wipe All</button>
    </div>

    <!-- Status -->
    <div id="titan-status" class="titan-status">Ready.</div>
</div>
